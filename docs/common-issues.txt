# Common Issues and Solutions

## Book Ingestion Admin

### Issue 1: iOS Chrome "load failed" on production admin dashboard
**Date**: 2025-10-26
**URL**: learnlikemagic.com/admin/books
**Symptom**: iOS Chrome showed "load failed" error when trying to access admin dashboard; worked fine on desktop
**Root Cause**: Frontend's `llm-frontend/src/features/admin/api/adminApi.ts` hardcoded `localhost:8000` instead of using `VITE_API_URL` environment variable that points to App Runner
**Fix**: Changed `const API_BASE_URL = 'http://localhost:8000'` to `const API_BASE_URL = import.meta.env.VITE_API_URL || import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000'`
**Commit**: b620ce5

### Issue 2: Production showing 0 pages despite pages uploaded locally
**Date**: 2025-10-26
**URL**: learnlikemagic.com/admin/books/ncert_mathematics_3_2024
**Symptom**: Book detail page showed "0 Total Pages", "0 Approved Pages" on production, but local backend returned 2 pages correctly
**Root Cause**: App Runner IAM role (`learnlikemagic-apprunner-instance-production`) missing S3 permissions to read `metadata.json` from `s3://learnlikemagic-books/`; local backend worked because it used `~/.aws/credentials`
**Fix**: Added IAM policy `app_runner_s3_books` in `infra/terraform/modules/app-runner/main.tf` with permissions: `s3:GetObject`, `s3:PutObject`, `s3:DeleteObject`, `s3:ListBucket` on `arn:aws:s3:::learnlikemagic-books` and `arn:aws:s3:::learnlikemagic-books/*`
**Commit**: b511e86
**Applied**: terraform apply (1 resource added)
